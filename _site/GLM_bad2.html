<!DOCTYPE html>
<html>
<!--custom header -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title> BADays (Bioinformatics Awareness Days)</title>
  <meta name="description" content="Bioinformatics Awareness Days (BAD days)">


  <link rel="shortcut icon" href="/BAD_days/images/dna.png" >

  <!-- Style sheets -->
  <!--Material bootstrap -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/css/mdb.min.css" rel="stylesheet" medial ="all">

  <!-- Font awesome -->
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" media="all">

  <!-- Boostrap-->
  <link rel="stylesheet" href="/BAD_days/css/main.css">


  <!-- URL -->
  <link rel="canonical" href="http://localhost:4000/BAD_days/GLM_bad2.html">


  <!-- The various JS scripts used in the website -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://use.fontawesome.com/ff95ae1185.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
  integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
  crossorigin="anonymous"></script>

<!-- add after bootstrap.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.4.1/dist/bootstrap-toc.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/js/mdb.min.js"></script>
<link src="/BAD_days/js/custom-scripts.js">


<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>

</head>


<!-- scroller for TOC-->
<body data-spy="scroll" data-target="#toc">

<!-- sidebar-->
  <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Bioinformatics Awareness Days (BAD days)</p>

    <p> Developed by Luisa Cutillo and the <a href='http://rse.shef.ac.uk'> RSE team
    </a> at the University of Sheffield</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/BAD_days/">Home</a>

    

    
    
      
    
      
        
        <!-- Note you need to prepend the site.baseurl always-->
          <a class="sidebar-nav-item"
          href="/BAD_days/1-outline/">Day 1</a>
        
      
    
      
        
        <!-- Note you need to prepend the site.baseurl always-->
          <a class="sidebar-nav-item"
          href="/BAD_days/2-outline/">Day 2</a>
        
      
    
      
        
        <!-- Note you need to prepend the site.baseurl always-->
          <a class="sidebar-nav-item"
          href="/BAD_days/3-outline/">Day 3</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
        <!-- Note you need to prepend the site.baseurl always-->
          <a class="sidebar-nav-item"
          href="/BAD_days/about/">Getting started</a>
        
      
    
      
    
      
        
      
    


    <a class="sidebar-nav-item" href="https://github.com/trallard/BAD_days">GitHub repository</a>
  </nav>

  <div class="sidebar-item">
    <p>
      The University of Sheffield &copy; 2017. CC-BY
    </p>
  </div>
</div>


<!--main content needs to be in a wrap for
when the sidebar is displayed-->
  <div class='wrap'>

<!-- navbar -->
  <!--Top navigation bar-->

    <nav class="navbar navbar-inverse">
      <div class="container-fluid">

        <a class="navbar-brand" href="/BAD_days/index.html"> </a>

        </div>
      </div>
    </nav>

</div>
<div class='wrap'>
  <div class="container">
    <div class="row">

<!--- Main content--->
      <div class="col-sm-8">
        <main>
          <h1 id="bad-day-2-generalized-linear-models">BAD DAY 2: Generalized linear models</h1>

<p><br /></p>
<font color="#00bcd4"> In [1]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#for more examples see: http://plantecology.syr.edu/fridley/bio793/glm.html
</span><span class="w">
</span><span class="n">setwd</span><span class="p">(</span><span class="n">getwd</span><span class="p">())</span></code></pre></figure>

<p>Generalized linear models (GLMs) extend the linear modeling capability of R to
scenarios that involve non-normal error distributions or heteroscedasticity.</p>

<p>All other classic assumptions (particularly independent observations) still
apply.  The idea here is that linear functions of the predictor variables are
obtained by a link function.  The data are then fit in this transformed scale
(using an iterative routine based on least squares), but the expected variance
is calculated on the original scale of the predictor variables.</p>

<p>Simple examples of link functions are $log(y)$ [which linearizes $exp(x)$],
$sqrt(y) [x^2]$, and $1/y$.  More particularly, GLMs work for the so-called
‘exponential’ family of error models: Poisson, binomial, Gamma, and normal.</p>

<h2 id="count-or-count-like-response-variables">Count (or count-like) response variables</h2>

<p><br /></p>
<font color="#00bcd4"> In [3]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s1">'./Data/treedata.csv'</span><span class="p">)</span><span class="w"> </span><span class="c1">#choose the treedata.csv dataset
</span><span class="n">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span><span class="nf">dim</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span><span class="n">dat2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="n">dat</span><span class="o">$</span><span class="n">species</span><span class="o">==</span><span class="s2">"Tsuga canadensis"</span><span class="p">)</span></code></pre></figure>

<table class="table-responsive table-striped">
<thead><tr><th scope="col">plotID</th><th scope="col">date</th><th scope="col">plotsize</th><th scope="col">spcode</th><th scope="col">species</th><th scope="col">cover</th><th scope="col">utme</th><th scope="col">utmn</th><th scope="col">elev</th><th scope="col">tci</th><th scope="col">streamdist</th><th scope="col">disturb</th><th scope="col">beers</th></tr></thead>
<tbody>
	<tr><td>ATBN-01-0403 </td><td>08-28-2001   </td><td> 1000        </td><td>ABIEFRA      </td><td>Abies fraseri</td><td>1            </td><td>275736       </td><td>3942439      </td><td>1660         </td><td>5.701460     </td><td>490.9        </td><td>CORPLOG      </td><td>0.22442864   </td></tr>
	<tr><td>ATBN-01-0532 </td><td>07-24-2002   </td><td> 1000        </td><td>ABIEFRA      </td><td>Abies fraseri</td><td>8            </td><td>302847       </td><td>3942772      </td><td>1712         </td><td>3.823586     </td><td>454.0        </td><td>VIRGIN       </td><td>0.83408785   </td></tr>
	<tr><td>ATBN-01-0533 </td><td>07-24-2002   </td><td> 1000        </td><td>ABIEFRA      </td><td>Abies fraseri</td><td>3            </td><td>303037       </td><td>3943039      </td><td>1722         </td><td>3.893762     </td><td>453.4        </td><td>LT-SEL       </td><td>1.33325863   </td></tr>
	<tr><td>ATBN-01-0536 </td><td>07-25-2002   </td><td> 1000        </td><td>ABIEFRA      </td><td>Abies fraseri</td><td>3            </td><td>273927       </td><td>3935488      </td><td>1754         </td><td>3.145527     </td><td>492.5        </td><td>SETTLE       </td><td>1.47124839   </td></tr>
	<tr><td>ATBP-01-0001 </td><td>05-11-1999   </td><td>10000        </td><td>ABIEFRA      </td><td>Abies fraseri</td><td>8            </td><td>273857       </td><td>3937870      </td><td>1945         </td><td>5.682065     </td><td>492.4        </td><td>VIRGIN       </td><td>1.64377141   </td></tr>
	<tr><td>ATBP-01-0005 </td><td>08-25-1999   </td><td>10000        </td><td>ABIEFRA      </td><td>Abies fraseri</td><td>4            </td><td>273876       </td><td>3935462      </td><td>1751         </td><td>5.417182     </td><td>545.9        </td><td>SETTLE       </td><td>0.00032873   </td></tr>
</tbody>
</table>

<ol class="list-inline">
	<li>8971</li>
	<li>13</li>
</ol>

<p><br /></p>
<font color="#00bcd4"> In [5]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mean</span><span class="p">(</span><span class="n">dat2</span><span class="o">$</span><span class="n">cover</span><span class="p">)</span></code></pre></figure>

<p>4.65951742627346</p>

<p><br /></p>
<font color="#00bcd4"> In [6]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">var</span><span class="p">(</span><span class="n">dat2</span><span class="o">$</span><span class="n">cover</span><span class="p">)</span></code></pre></figure>

<p>4.471835471508</p>

<p><br /></p>
<font color="#00bcd4"> In [7]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">table</span><span class="p">(</span><span class="n">dat2</span><span class="o">$</span><span class="n">cover</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>  1   2   3   4   5   6   7   8   9  10
 39  71 166 110  92  80 108  60  19   1
</code></pre>
</div>

<p>If these counts were distributed exactly from a Poisson process, what would they
look like, assuming the same mean (and variance)?</p>

<p><br /></p>
<font color="#00bcd4"> In [12]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">bar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">barplot</span><span class="p">(</span><span class="n">as.vector</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">dat2</span><span class="o">$</span><span class="n">cover</span><span class="p">)),</span><span class="n">names.arg</span><span class="o">=</span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'lightblue2'</span><span class="p">,</span><span class="w">
              </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'white'</span><span class="p">)</span><span class="w">

</span><span class="n">points</span><span class="p">(</span><span class="n">bar1</span><span class="p">,</span><span class="n">dpois</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="m">4.66</span><span class="p">)</span><span class="o">*</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">dat2</span><span class="o">$</span><span class="n">cover</span><span class="p">)),</span><span class="w">

     </span><span class="n">cex</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'mediumpurple'</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">)</span><span class="w">
</span><span class="c1">#?dpois
</span><span class="w">
</span><span class="n">box</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/BAD_days/notebooks/GLM_bad2_files/GLM_bad2_9_0.png" alt="png" /></p>

<p><br /></p>
<font color="#00bcd4"> In [13]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="err">#</span><span class="o">?</span><span class="n">glm</span></code></pre></figure>

<p>As you can see, the data look Poisson-ish but they’re not perfect.  (One reason
you’ve probably already guessed: our data are bounded at 10, so variance should
actually go down for the highest values.)</p>

<p>Now let’s fit a GLM to these data with just an intercept (overall mean):</p>

<p><br /></p>
<font color="#00bcd4"> In [14]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">glm1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">cover</span><span class="o">~</span><span class="m">1</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dat2</span><span class="p">,</span><span class="n">family</span><span class="o">=</span><span class="n">poisson</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">glm1</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Call:
glm(formula = cover ~ 1, family = poisson, data = dat2)

Deviance Residuals:
    Min       1Q   Median       3Q      Max  
-2.0594  -0.8229  -0.3132   1.0085   2.1430  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.53891    0.01696   90.73   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 749.25  on 745  degrees of freedom
Residual deviance: 749.25  on 745  degrees of freedom
AIC: 3212.2

Number of Fisher Scoring iterations: 4
</code></pre>
</div>

<p>Let’s add a continuous predictor variable like elevation to generate a simple
Poisson regression.  First we’ll graph it:</p>

<p>And then we’ll fit the new glm and test it against a model with only an
intercept:</p>

<p><br /></p>
<font color="#00bcd4"> In [16]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">with</span><span class="p">(</span><span class="n">dat2</span><span class="p">,</span><span class="n">plot</span><span class="p">(</span><span class="n">elev</span><span class="p">,</span><span class="n">cover</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="s2">"Hemlock cover vs. elevation"</span><span class="p">,</span><span class="w">      
               </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'midnightblue'</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">))</span></code></pre></figure>

<p><img src="http://localhost:4000/BAD_days/notebooks/GLM_bad2_files/GLM_bad2_14_0.png" alt="png" /></p>

<p>Note the chi-squared test is typically recommended for models with ‘known
deviance’ (Poisson and binomial).  Here the model with elevation adds no
explanatory power (fairly obvious from the graph), but we can still add the
predicted trend line to our graph:</p>

<p><br /></p>
<font color="#00bcd4"> In [17]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1660</span><span class="p">)</span><span class="w">
</span><span class="c1">#plot.new()
#lines(predict(glm2,list(elev=x),type="response"),lwd=2,col="orange")
</span><span class="w">
</span><span class="c1">#What is crucial here is the type argument to predict: "response" re-calculates the coefficients to be on the same scale as the original response variable, rather than the scale of the link function.  Let's now try an ANOVA with Poisson error, using disturbance as our predictor:
</span><span class="w">
</span><span class="n">glm3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">cover</span><span class="o">~</span><span class="n">disturb</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat2</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poisson</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">glm3</span><span class="p">)</span><span class="w">
</span><span class="n">anova</span><span class="p">(</span><span class="n">glm1</span><span class="p">,</span><span class="w"> </span><span class="n">glm3</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Chisq"</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Call:
glm(formula = cover ~ disturb, family = poisson, data = dat2)

Deviance Residuals:
    Min       1Q   Median       3Q      Max  
-2.1794  -0.7763  -0.1980   0.8523   2.2006  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    1.48367    0.03838  38.661   &lt;2e-16 ***
disturbLT-SEL  0.03204    0.04685   0.684    0.494    
disturbSETTLE  0.08957    0.05485   1.633    0.103    
disturbVIRGIN  0.12184    0.05277   2.309    0.021 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 749.25  on 745  degrees of freedom
Residual deviance: 742.32  on 742  degrees of freedom
AIC: 3211.3

Number of Fisher Scoring iterations: 4
</code></pre>
</div>

<table class="table-responsive table-striped">
<thead><tr><th scope="col">Resid. Df</th><th scope="col">Resid. Dev</th><th scope="col">Df</th><th scope="col">Deviance</th><th scope="col">Pr(&gt;Chi)</th></tr></thead>
<tbody>
	<tr><td>745       </td><td>749.2497  </td><td>NA        </td><td>      NA  </td><td>        NA</td></tr>
	<tr><td>742       </td><td>742.3237  </td><td> 3        </td><td>6.926019  </td><td>0.07429355</td></tr>
</tbody>
</table>

<p><br /></p>
<font color="#00bcd4"> In [18]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">glm2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">cover</span><span class="o">~</span><span class="n">elev</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat2</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poisson</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">glm2</span><span class="p">)</span><span class="w">
</span><span class="n">anova</span><span class="p">(</span><span class="n">glm1</span><span class="p">,</span><span class="n">glm2</span><span class="p">,</span><span class="n">test</span><span class="o">=</span><span class="s2">"Chisq"</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Call:
glm(formula = cover ~ elev, family = poisson, data = dat2)

Deviance Residuals:
    Min       1Q   Median       3Q      Max  
-2.0673  -0.8250  -0.3048   0.9991   2.1347  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.546e+00  5.135e-02  30.115   &lt;2e-16 ***
elev        -8.448e-06  5.471e-05  -0.154    0.877    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 749.25  on 745  degrees of freedom
Residual deviance: 749.23  on 744  degrees of freedom
AIC: 3214.2

Number of Fisher Scoring iterations: 4
</code></pre>
</div>

<table class="table-responsive table-striped">
<thead><tr><th scope="col">Resid. Df</th><th scope="col">Resid. Dev</th><th scope="col">Df</th><th scope="col">Deviance</th><th scope="col">Pr(&gt;Chi)</th></tr></thead>
<tbody>
	<tr><td>745       </td><td>749.2497  </td><td>NA        </td><td>        NA</td><td>       NA </td></tr>
	<tr><td>744       </td><td>749.2259  </td><td> 1        </td><td>0.02384893</td><td>0.8772699 </td></tr>
</tbody>
</table>

<p><br /></p>
<font color="#00bcd4"> In [19]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">glm4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">cover</span><span class="o">~</span><span class="n">disturb</span><span class="o">*</span><span class="n">elev</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dat2</span><span class="p">,</span><span class="n">family</span><span class="o">=</span><span class="n">poisson</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">glm4</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Call:
glm(formula = cover ~ disturb * elev, family = poisson, data = dat2)

Deviance Residuals:
    Min       1Q   Median       3Q      Max  
-2.4042  -0.7782  -0.2072   0.8090   2.0888  

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         1.445e+00  1.396e-01  10.352   &lt;2e-16 ***
disturbLT-SEL       2.546e-01  1.639e-01   1.554   0.1203    
disturbSETTLE      -3.702e-01  2.275e-01  -1.628   0.1036    
disturbVIRGIN       9.283e-02  2.625e-01   0.354   0.7236    
elev                3.540e-05  1.243e-04   0.285   0.7758    
disturbLT-SEL:elev -2.788e-04  1.651e-04  -1.689   0.0912 .  
disturbSETTLE:elev  7.319e-04  2.943e-04   2.487   0.0129 *  
disturbVIRGIN:elev  2.278e-05  2.269e-04   0.100   0.9200    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 749.25  on 745  degrees of freedom
Residual deviance: 729.06  on 738  degrees of freedom
AIC: 3206

Number of Fisher Scoring iterations: 4
</code></pre>
</div>

<p><br /></p>
<font color="#00bcd4"> In [20]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">step</span><span class="p">(</span><span class="n">glm4</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Call:  glm(formula = cover ~ disturb * elev, family = poisson, data = dat2)

Coefficients:
       (Intercept)       disturbLT-SEL       disturbSETTLE       disturbVIRGIN  
         1.445e+00           2.546e-01          -3.702e-01           9.283e-02  
              elev  disturbLT-SEL:elev  disturbSETTLE:elev  disturbVIRGIN:elev  
         3.540e-05          -2.788e-04           7.319e-04           2.278e-05  

Degrees of Freedom: 745 Total (i.e. Null);  738 Residual
Null Deviance:	    749.2
Residual Deviance: 729.1 	AIC: 3206
</code></pre>
</div>

<p>The ANOVA contrasts suggest a significant difference in slope with elevation in
the plots of prior settlement:
disturbSETTLE:elev  0.0129 *;
the step function shows that the interaction is necessary (large increase in AIC
when the interaction is removed).</p>

<p><br /></p>
<font color="#00bcd4"> In [1]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="err">#</span><span class="o">?</span><span class="n">step</span></code></pre></figure>

<p><br /></p>
<font color="#00bcd4"> In [2]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="err">#</span><span class="n">st</span><span class="o">=</span><span class="n">step</span><span class="p">(</span><span class="n">glm4</span><span class="p">)</span></code></pre></figure>

<p><br /></p>
<font color="#00bcd4"> In [3]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="err">#</span><span class="n">st</span><span class="o">$</span><span class="n">anova</span></code></pre></figure>


        </main>
      </div>

      <div class="col-sm-1">
      </div>
      <!-- TOC sidebar, which will move to the top on a small screen -->
      <div class="col-sm-3 container-toc">
        <nav id="toc" data-spy="affix" data-toggle="toc"></nav>
      </div>


    </div>
  </div>
</div>

<label for="sidebar-checkbox" class="sidebar-toggle"></label>

<div class='container'>
  <div class='row'>
    <div class="col-sm-8">
    <!-- return to outline-->
<a href = 'http://localhost:4000/BAD_days/2-outline/' class="btn btn-purple">
  <i class="fa fa-magic left"></i> Day2: outline</a>


<!--download-->
<a href="http://localhost:4000/BAD_days/notebooks/GLM_bad2.ipynb" download="GLM_bad2.ipynb" class="float" >
<i class="fa fa-download my-float"></i>
</a>
<div class="label-container">
<div class="label-text">If download does not start: right-click and 
                  'Download linked file as'</div>
</div>
<br>

    <br>
  </div>
  </div>
</div>

</body>


</html>
